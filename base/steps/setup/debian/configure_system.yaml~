# # System Config
- configure_locales:
  # set locales programtically, based on http://linux.livejournal.com/1880366.html
  - exec_in: |
      test ! -f /etc/locale.gen || \
        (echo $$locales | tr ' ' '\n' | xargs -I {} sed -i 's/^# {}/{}/' /etc/locale.gen)
  - exec_in: locale-gen $$lang
  - exec_in: update-locale LANG=$$lang

- set_timezone:
  - exec_in: echo "$$timezone" > /etc/timezone
  - exec_in: "dpkg-reconfigure -f noninteractive tzdata 2>&1"

- create_iniittab:
  - write_in:
    - /etc/inittab
    - |
      id:3:initdefault:
      si::sysinit:/etc/init.d/rcS
      l0:0:wait:/etc/init.d/rc 0
      l1:1:wait:/etc/init.d/rc 1
      l2:2:wait:/etc/init.d/rc 2
      l3:3:wait:/etc/init.d/rc 3
      l4:4:wait:/etc/init.d/rc 4
      l5:5:wait:/etc/init.d/rc 5
      l6:6:wait:/etc/init.d/rc 6
      # Normally not reached, but fallthrough in case of emergency.
      z6:6:respawn:/sbin/sulogin
      1:2345:respawn:/sbin/getty 38400 console
      c1:12345:respawn:/sbin/getty 38400 tty1 linux
      c2:12345:respawn:/sbin/getty 38400 tty2 linux
      c3:12345:respawn:/sbin/getty 38400 tty3 linux
      c4:12345:respawn:/sbin/getty 38400 tty4 linux
      p6::ctrlaltdel:/sbin/init 6
      p0::powerfail:/sbin/init 0
